<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>the-Particle v3.1</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- 背景エフェクトレイヤー -->
  <div id="bg-grid"></div>
  <div id="glitch-layer" class="glitch-overlay"></div>
  
  <!-- ニュースティッカー (上部固定) -->
  <div class="news-ticker-container">
    <div class="news-label">NEWS</div>
    <div class="news-viewport">
      <div class="news-content" id="news-content">
        System initialized... 粒子生成プロセスを開始します...
      </div>
    </div>
  </div>

  <div class="app-wrapper" id="app-wrapper">
    <!-- メインパネル -->
    <main class="game-panel">
      <header>
        <h1>the-Particle <span style="font-size:0.5em; color:var(--accent-color);">v3.1</span></h1>
        
        <!-- 進捗バーセクション -->
        <div class="progress-section">
          <div class="progress-row">
            <span class="prog-label">Next Linac</span>
            <div class="progress-bar-bg"><div class="progress-bar-fill" id="prog-linac"></div></div>
            <span class="prog-val" id="prog-linac-text">0%</span>
          </div>
          <div class="progress-row" id="shift-prog-row" style="display:none;">
            <span class="prog-label" style="color:var(--shift-color);">Next Shift</span>
            <div class="progress-bar-bg"><div class="progress-bar-fill shift" id="prog-shift"></div></div>
            <span class="prog-val" id="prog-shift-text">0%</span>
          </div>
        </div>

        <div class="currency-container">
          <h2 id="particle-display">0 粒子</h2>
          <p id="pps-display">(+0.00 /秒)</p>
        </div>
        
        <div id="ip-display-container" style="display:none;">
          Infinity Points: <span id="ip-val">0</span>
        </div>
      </header>

      <!-- シフト情報 -->
      <div id="shift-status" class="shift-bar" style="display: none;">
        現在のライナック倍率: <span id="shift-mult-display">x1.2</span>
        <span style="font-size:0.8em; color:#888; margin-left:10px;">(シフト回数: <span id="shift-count">0</span>)</span>
      </div>

      <!-- プレステージバナー -->
      <div id="prestige-container" class="prestige-banner" style="display: none;">
        <div class="prestige-info">
          現在のライナック数: <span id="current-linac-count">0</span>
        </div>
        <div class="prestige-actions">
          <button class="prestige-btn" id="btn-linac" onclick="doLinac()">
            <strong>ライナックを実行 [L]</strong><br>
            <span class="sub-text">生産倍率UP & リセット</span>
          </button>
          <button class="prestige-btn shift-btn" id="btn-shift" onclick="doLinacShift()" style="display:none;">
            <strong>ライナック・シフト [S+L]</strong><br>
            <span class="sub-text">全てを失い、次元を超越</span>
          </button>
        </div>
      </div>

      <!-- コントロール -->
      <div class="control-bar">
        <div class="control-left">
          <span class="control-label">購入量:</span>
          <div class="toggle-group">
            <button class="toggle-btn active" onclick="setBuyAmount(1)" id="buy-1">x1</button>
            <button class="toggle-btn" onclick="setBuyAmount(10)" id="buy-10">x10</button>
            <button class="toggle-btn" onclick="setBuyAmount(100)" id="buy-100">x100</button>
          </div>
        </div>
        <button class="buy-btn max-all-btn" onclick="buyMaxAll()">MAX ALL [M]</button>
      </div>

      <!-- ジェネレーターリスト -->
      <div id="generator-container">
        <!-- JSで生成 -->
      </div>

      <button id="sidebar-open-btn" class="float-menu-btn" onclick="toggleSidebar()">⚙ MENU</button>
    </main>

    <!-- サイドバー -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="tab-container">
          <button class="tab-btn active" onclick="switchTab('stats', this)">統計</button>
          <button class="tab-btn" onclick="switchTab('settings', this)">設定</button>
        </div>
        <button class="close-btn" onclick="toggleSidebar()">✕</button>
      </div>

      <div class="sidebar-body">
        <!-- 統計タブ -->
        <div id="tab-stats" class="sidebar-content active">
          <h3>STATISTICS</h3>
          <div class="stat-row"><span class="stat-label">プレイ時間</span><span id="stat-time" class="stat-val">00:00:00</span></div>
          <div class="stat-row"><span class="stat-label">総生産粒子</span><span id="stat-total" class="stat-val">0</span></div>
          <div class="stat-row" id="row-prestige" style="display:none;"><span class="stat-label">ライナック回数</span><span id="stat-prestige" class="stat-val">0</span></div>
          
          <div id="infinity-stats" style="display:none; margin-top:20px; border-top:1px dashed #555; padding-top:10px;">
            <h3 style="color:var(--infinity-color);">COSMIC STATS</h3>
            <div class="stat-row"><span class="stat-label">Big Crunch</span><span id="stat-crunch" class="stat-val">0</span></div>
          </div>
        </div>

        <!-- 設定タブ -->
        <div id="tab-settings" class="sidebar-content">
          <h3>GAMEPLAY</h3>
          <div class="setting-group checkbox-group">
            <label class="custom-checkbox">
              <input type="checkbox" id="chk-skip-confirm" onchange="toggleSkipConfirm(this)">
              <span class="checkmark"></span>
              リセット確認をスキップ
            </label>
          </div>

          <h3>DISPLAY</h3>
          <div class="setting-group">
            <label class="setting-label">数値表記</label>
            <div class="select-wrapper">
              <select id="notation-select" onchange="changeNotation(this.value)">
                <option value="sci">科学的単位 (1.00e5)</option>
                <option value="eng">英語単位 (100 k)</option>
                <option value="jp">日本語単位 (10 万)</option>
              </select>
            </div>
          </div>

          <h3>DATA</h3>
          <div class="setting-group">
            <button class="ui-btn primary" onclick="saveGame()">手動セーブ [S]</button>
            <div class="status-text" id="save-status">オートセーブ: ON (10s)</div>
          </div>
          <div class="setting-group">
            <button class="ui-btn secondary" onclick="exportSaveToClipboard()">クリップボードへ書き出し</button>
            <button class="ui-btn secondary" onclick="importSaveFromClipboard()">クリップボードから読み込み</button>
          </div>

          <div class="setting-group danger-zone">
            <h4>DANGER ZONE</h4>
            <button class="ui-btn danger" onclick="hardReset()">データ完全消去</button>
          </div>
        </div>
      </div>
      <div class="sidebar-footer">ver 3.1.0 Quantum Loop</div>
    </aside>
  </div>

  <!-- カスタムモーダル (Alert/Confirm代替) -->
  <div id="custom-modal-overlay" class="modal-overlay" style="display:none;">
    <div class="modal-box">
      <h3 id="modal-title">TITLE</h3>
      <div id="modal-body" class="modal-body">Content</div>
      <div class="modal-actions" id="modal-actions"></div>
    </div>
  </div>

  <!-- トースト通知エリア -->
  <div id="toast-container" class="toast-container"></div>

  <!-- ビッグ・クランチ演出 -->
  <div id="crunch-overlay" class="crunch-overlay" style="display: none;">
    <div class="crunch-message">
      <h1>UNIVERSE COLLAPSED</h1>
      <p>宇宙は粒子の重みに耐えきれませんでした</p>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
